{"ast":null,"code":"export {};\n/*\r\nimport { HttpClient } from \"@angular/common/http\";\r\nimport { Injectable } from \"@angular/core\";\r\nimport { json } from \"express\";\r\nimport { BehaviorSubject, Observable } from \"rxjs\";\r\nimport { environment } from \"src/environments/environment\";\r\nimport { ApplicationUserLogin } from \"../models/account/application-user-login.models\";\r\nimport { ApplicationUser } from \"../models/account/application-user.model\";\r\nimport { map, mapTo } from 'rxjs/operators';\r\nimport { ApplicationUserCreate } from \"../models/account/application-user-create.models\";\r\n\r\n@Injectable({\r\n  providedIn:'root'\r\n})\r\n\r\nexport class AccountService{\r\n  private currentUserSubject$!: BehaviorSubject<ApplicationUser>;\r\n  constructor(\r\n    private http: HttpClient\r\n  ){\r\n\r\n    this.currentUserSubject$=new BehaviorSubject<ApplicationUser>(JSON.parse(localStorage.getItem('blogLab-currentUser')||'{}'));\r\n  }\r\n\r\n  login(model: ApplicationUserLogin) : Observable<ApplicationUser>  {\r\n    return this.http.post<ApplicationUser>(`${environment.webApi}/Account/login`, model).pipe(\r\n      map((user : ApplicationUser) => {\r\n\r\n        if (user) {\r\n          localStorage.setItem('blogLab-currentUser', JSON.stringify(user));\r\n          this.setCurrentUser(user);\r\n        }\r\n\r\n        return user;\r\n      })\r\n    )\r\n  }\r\n\r\n  register(model: ApplicationUserCreate) : Observable<ApplicationUser> {\r\n    return this.http.post<ApplicationUser>(`${environment.webApi}/Account/register`, model).pipe(\r\n      map((user : ApplicationUser) => {\r\n\r\n        if (user) {\r\n          localStorage.setItem('blogLab-currentUser', JSON.stringify(user));\r\n          this.setCurrentUser(user);\r\n        }\r\n\r\n        return user;\r\n      })\r\n    )\r\n  }\r\n\r\n\r\n  setCurrentUser(user: ApplicationUser) {\r\n    this.currentUserSubject$.next(user);\r\n  }\r\n\r\n  public get currentUserValue(): ApplicationUser {\r\n    return this.currentUserSubject$.value;\r\n  }\r\n\r\n  public givenUserIsLoggedIn(username: string) {\r\n    return this.isLoggedIn() && this.currentUserValue.username === username;\r\n  }\r\n\r\n  public isLoggedIn() {\r\n    const currentUser = this.currentUserValue;\r\n    const isLoggedIn = !!currentUser && !!currentUser.token;\r\n    return isLoggedIn;\r\n  }\r\n\r\n  logout() {\r\n    localStorage.removeItem('blogLab-currentUser');\r\n    this.currentUserSubject$.next;\r\n  }\r\n}\r\n*/","map":null,"metadata":{},"sourceType":"module"}