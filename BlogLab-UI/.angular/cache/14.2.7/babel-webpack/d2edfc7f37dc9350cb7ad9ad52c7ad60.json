{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { BlogCreate } from 'src/app/models/blog/blog-create.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"src/app/services/blog.service\";\nimport * as i4 from \"src/app/services/photo.service\";\nimport * as i5 from \"ngx-toastr\";\nexport let BlogEditComponent = /*#__PURE__*/(() => {\n  class BlogEditComponent {\n    constructor(route, formBuilder, blogService, photoService, toastr) {\n      this.route = route;\n      this.formBuilder = formBuilder;\n      this.blogService = blogService;\n      this.photoService = photoService;\n      this.toastr = toastr;\n      this.confirmImageDelete = false;\n      this.userPhotos = [];\n    }\n\n    ngOnInit() {\n      const blogId = parseInt(this.route.snapshot.params['id']);\n      this.blogForm = this.formBuilder.group({\n        blogId: [blogId],\n        title: ['', [Validators.required, Validators.minLength(10), Validators.maxLength(50)]],\n        content: ['', [Validators.required, Validators.minLength(300), Validators.maxLength(5000)]],\n        photoDescription: [null],\n        photoId: [null]\n      });\n      this.photoService.getByApplicationUserId().subscribe(userPhotos => {\n        this.userPhotos = userPhotos;\n      });\n\n      if (!!blogId && blogId !== -1) {\n        this.blogService.get(blogId).subscribe(blog => {\n          this.updateForm(blog);\n        });\n      }\n    }\n\n    getPhoto(photoId) {\n      for (let i = 0; i < this.userPhotos.length; i++) {\n        if (this.userPhotos[i].photoId === photoId) {\n          return this.userPhotos[i];\n        }\n      }\n\n      return null;\n    }\n\n    isTouched(field) {\n      return this.blogForm.get(field)?.touched;\n    }\n\n    hasErrors(field) {\n      return this.blogForm.get(field)?.errors;\n    }\n\n    hasError(field, error) {\n      return !!this.blogForm.get(field)?.hasError(error);\n    }\n\n    isNew() {\n      return parseInt(this.blogForm.get('blogId')?.value) === -1;\n    }\n\n    detachPhoto() {\n      this.blogForm.patchValue({\n        photoId: null,\n        photoDescription: null\n      });\n    }\n\n    updateForm(blog) {\n      let photoDescription = this.getPhoto(blog.photoId)?.description;\n      this.blogForm.patchValue({\n        blogId: blog.blogId,\n        title: blog.title,\n        content: blog.content,\n        photoId: blog.photoId,\n        photoDescription: photoDescription\n      });\n    }\n\n    onSelect(event) {\n      let chosenPhoto = event.item;\n      this.blogForm.patchValue({\n        photoId: chosenPhoto.photoId,\n        photoDescription: chosenPhoto.description\n      });\n    }\n\n    onSubmit() {\n      let blogCreate = new BlogCreate(this.blogForm.get(\"blogId\")?.value, this.blogForm.get(\"title\")?.value, this.blogForm.get(\"content\")?.value, this.blogForm.get(\"photoId\")?.value);\n      this.blogService.create(blogCreate).subscribe(createdBlog => {\n        this.updateForm(createdBlog);\n        this.toastr.info(\"Blog saved.\");\n      });\n    }\n\n  }\n\n  BlogEditComponent.ɵfac = function BlogEditComponent_Factory(t) {\n    return new (t || BlogEditComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.BlogService), i0.ɵɵdirectiveInject(i4.PhotoService), i0.ɵɵdirectiveInject(i5.ToastrService));\n  };\n\n  BlogEditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BlogEditComponent,\n    selectors: [[\"app-blog-edit\"]],\n    decls: 2,\n    vars: 0,\n    template: function BlogEditComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"p\");\n        i0.ɵɵtext(1, \"blog-edit works!\");\n        i0.ɵɵelementEnd();\n      }\n    }\n  });\n  return BlogEditComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}